# WhatsApp Reminder

–≠—Ç–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–π —á–µ—Ä–µ–∑ WhatsApp. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –≤ —Ñ–æ—Ä–º–∞—Ç–µ "–ù–∞–ø–æ–º–Ω–∏ –≤ YYYY-MM-DD HH:MM —Ç–µ–∫—Å—Ç", –∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ, –∞ –∑–∞—Ç–µ–º –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –µ–≥–æ –≤ —É–∫–∞–∑–∞–Ω–Ω–æ–µ –≤—Ä–µ–º—è.

## –ß—Ç–æ –æ–Ω–æ –¥–µ–ª–∞–µ—Ç?
- –ü—Ä–∏–Ω–∏–º–∞–µ—Ç –∫–æ–º–∞–Ω–¥—ã —á–µ—Ä–µ–∑ WhatsApp —Å –ø–æ–º–æ—â—å—é GreenAPI.
- –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö PostgreSQL.
- –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤ –∑–∞–¥–∞–Ω–Ω–æ–µ –≤—Ä–µ–º—è —á–µ—Ä–µ–∑ Celery.

üõ† ## –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

- **Django**
- **GreenAPI**
- **Celery**
- **Redis**
- **PostgreSQL**
- **Docker**
- **ngrok**
- **nginx**

üìã ## –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Python 3.10
- Docker –∏ Docker Compose
- –ê–∫–∫–∞—É–Ω—Ç GreenAPI ([green-api.com](https://green-api.com/))
- Redis
- PostgreSQL
- ngrok

üîß 1) –°–∫–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π https://github.com/Vlad29012003/WhatsAppReminder.git

üîß 2) 2. –ù–∞—Å—Ç—Ä–æ–π –æ–∫—Ä—É–∂–µ–Ω–∏–µ .env
  
SECRET_KEY='django-insecure-i5if%5v%9f#cggyv7i@o)@-d36$g^d3&ncjn8$y_w)@2o5zu@2'
DJANGO_SETTINGS_MODULE=core.settings.base
DEBUG=True
POSTGRES_DB=reminder_db
POSTGRES_USER=postgres
POSTGRES_PASSWORD=postgres
POSTGRES_HOST=db
POSTGRES_PORT=5432

GREEN_API_BASE_URL=https://7105.api.greenapi.com
GREEN_API_ID_INSTANCE=7105196977
GREEN_API_TOKEN_INSTANCE=df0c691ab9e24a4eb65a060e9f04b46313fb402262eb4123bb
GREEN_API_PHONE_NUMBER=996707828028


3. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ  –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
pip install -r requirements.txt

–ï—Å–ª–∏ —Å Docker, –ø—Ä–æ–ø—É—Å—Ç–∏ —ç—Ç–æ—Ç —à–∞–≥.

4) –ù–∞—Å—Ç—Ä–æ–π GreenAPI
–≤–æ–π–¥–∏—Ç–µ –≤ green api –∏ —Å–æ–∑–¥–∞–π—Ç–µ –∏–Ω—Å—Ç–∞–Ω—Å
–£–∫–∞–∂–∏ –≤–µ–±—Ö—É–∫ URL: <ngrok_url>/api/reminders/webhook/ (–Ω–∞–ø—Ä–∏–º–µ—Ä, https://cfd4-92-62-70-32.ngrok-free.app/api/reminders/webhook/). –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –∫–æ—Ç–æ—Ä—ã–π —É –≤–∞—Å –±—É–¥–µ—Ç –≤ ngrok

5) –ó–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —á–µ—Ä–µ–∑ Docker
6) docker-compose up --build + –ø–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–º–∞–Ω–¥—ã
7) docker stop $(docker ps -a -q)
8) docker rm -f $(docker ps -aq)
9) docker rmi $(docker images -q)
10) docker-compose up --d
11) docker-compose up --build



–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
–û—Ç–ø—Ä–∞–≤—å —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ WhatsApp –Ω–∞ –≤–∞—à –Ω–æ–º–µ—Ä —Å –¥—Ä—É–≥–æ–≥–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ 

–ò–ó–í–ï–°–¢–ù–´–ï –ü–†–û–ë–õ–ï–ú–ú–´ –ò –†–ï–®–ï–ù–ò–Ø (–∫–æ—Ç–æ—Ä—ã–µ —è –ª–∏—á–Ω–æ –∑–∞–º–µ—Ç–∏–ª)

–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Twilio 
–ü—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ –ø–æ–¥–∫–ª—é—á–∏—Ç—å –Ω–æ–º–µ—Ä Twilio –≤—ã–¥–∞–≤–∞–ª –æ—à–∏–±–∫—É:
(Too many attempts, please try again after some time) —Ç–∞–∫ –∫–∞–∂–¥—ã–π —á–∞—Å –±–µ–∑ –¥–æ—Å—Ç—É–ø–∞ –∫ –ø–ª–∞—Ç—Ñ–æ—Ä–º–µ 

–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ GrenAPI
–í–µ–±—Ö—É–∫–∏ –∑–∞—Å—Ç—Ä–µ–≤–∞—é—Ç
–û–¥–Ω–æ –∏ —Ç–æ –∂–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–≤—Ç–æ—Ä—è–µ—Ç—Å—è –≤ –ª–æ–≥–∞—Ö.
GreenAPI –Ω–µ —É–¥–∞–ª—è–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –∏–∑ –æ—á–µ—Ä–µ–¥–∏.
–†–µ—à–µ–Ω–∏–µ –ì–µ–º–æ—Ä–æ–π–Ω–æ–µ —ç—Ç–æ –∑–∞–Ω–æ–≤–æ –ø–µ—Ä–µ—Ä–µ–≥–µ—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è –∏ —Å–æ–∑–¥–∞–≤–∞—Ç—å –Ω–æ–≤—ã–π –∏–Ω—Å—Ç–∞–Ω—Å –Ω–æ –∏ –≤ —Ç–∞–∫–æ–º —Å–ª—É—á–∞–µ –æ–Ω –±—É–¥–µ—Ç –±—Ä–∞—Ç—å —Ç–æ–ª—å–∫–æ –æ–¥–Ω–æ —Å–æ–æ–±—â–µ–Ω–∏–µ –∏ —Ç–æ–ª—å–∫–æ –æ—Ç –æ–¥–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è 

 
–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ WATI 
–ü—Ä–æ–±–ª–µ–º–∞ —Å WATI
WATI –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –±–µ—Å–ø–ª–∞—Ç–Ω—ã–π —Ç–∞—Ä–∏—Ñ Web hooks  –∫—É–¥–∞ –º–æ–∂–Ω–æ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —ç–Ω–¥–ø–æ–∏–Ω—Ç


–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Yowsup
—Ç–∞–∫ –∫–∞–∫ Yowsup –Ω–µ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–∞—è –±–∏–±–ª–µ–æ—Ç–µ–∫–∞ –≤–∞—Ç—Å–∞–ø –æ–±–Ω–æ–≤–∏–ª —Å–≤–æ—é –∑–∞—â–∏—Ç—É –ø–æ—ç—Ç–æ–º—É –µ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —É—Å—Ç–∞—Ä–µ–ª–æ ( –ø–æ –º–æ–µ–º—É –º–Ω–µ–Ω–∏—é :)
–ø–æ—Å–ª–µ–¥–Ω–∏–µ –±–æ–ª—å—à–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –±—ã–ª–∏ –±–æ–ª—å—à–µ 2 –ª–µ—Ç –Ω–∞–∑–∞–¥



–ü–†–û–ë–õ–ï–ú–ú–´ –° –§–£–ù–ö–¶–ò–û–ù–ê–õ–¨–ù–û–°–¢–¨–Æ 

–ë–æ—Ç –Ω–µ –ø–æ–ª–Ω–æ—Å—Ç—å—é –≤—ã–ø–æ–ª–Ω—è–µ—Ç —Å–≤–æ—é –∑–∞–¥–∞—á—É –∏–∑-–∑–∞ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤:
–ú–Ω–æ–≥–∏–µ —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–Ω—ã–µ API (Twilio, WATI, Yowsup) –ª–∏–±–æ –Ω–µ —Ä–∞–±–æ—Ç–∞–ª–∏ —Å –Ω–æ–º–µ—Ä–æ–º, –ª–∏–±–æ –±—ã–ª–∏ –ø–ª–∞—Ç–Ω—ã–º–∏, –ª–∏–±–æ —É—Å—Ç–∞—Ä–µ–ª–∏.
GreenAPI, —Ö–æ—Ç—å –∏ –±–µ—Å–ø–ª–∞—Ç–Ω—ã–π, —á–∞—Å—Ç–æ "–∑–∞—Å—Ç—Ä–µ–≤–∞–µ—Ç" –Ω–∞ –≤–µ–±—Ö—É–∫–∞—Ö, —á—Ç–æ –ª–æ–º–∞–µ—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –æ—Ç–ø—Ä–∞–≤–∫–∏ –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π.
–í —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è –º–æ–≥—É—Ç –Ω–µ –¥–æ—Ö–æ–¥–∏—Ç—å –≤–æ–≤—Ä–µ–º—è –∏–ª–∏ –≤–æ–æ–±—â–µ –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å—Å—è –∏–∑-–∑–∞ —ç—Ç–∏—Ö —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π.




–º–æ–∏ —Å–∏–ª—å–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã
–ù–µ—Å–º–æ—Ç—Ä—è –Ω–∞ –ø—Ä–æ–±–ª–µ–º—ã —Å WhatsApp-–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–º–∏, –æ–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ —Å–ª–µ–¥—É—é—â–∏–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è –ø—Ä–æ–µ–∫—Ç–∞:

** –°–ë–û–†–ö–ê DOCKER C NGINX –ò PGBOUNCER **
–ü—Ä–æ–µ–∫—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∏—Ä–æ–≤–∞–Ω —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Docker Compose.
Nginx –Ω–∞—Å—Ç—Ä–æ–µ–Ω –∫–∞–∫ –æ–±—Ä–∞—Ç–Ω—ã–π –ø—Ä–æ–∫—Å–∏ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∑–∞–ø—Ä–æ—Å–æ–≤.
PgBouncer –¥–æ–±–∞–≤–ª–µ–Ω –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π –∫ PostgreSQL, —á—Ç–æ —É–ª—É—á—à–∞–µ—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö



** SWAGGER –î–õ–Ø API: **
–î–æ–±–∞–≤–ª–µ–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤ —á–µ—Ä–µ–∑ Swagger –ø–æ –ø—É—Ç–∏ 
(–≤–∞—à –∞–ø–∏)
http://192.168.31.220/api/swagger/



** –¢–ï–°–¢–´: **
–ù–∞–ø–∏—Å–∞–Ω—ã unit-—Ç–µ—Å—Ç—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤ –∏ –ª–æ–≥–∏–∫–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π 
–≠–Ω–¥–ø–æ–∏–Ω—Ç –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π:


–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω —ç–Ω–¥–ø–æ–∏–Ω—Ç /api/reminders/send-message/ (POST), –ø–æ–∑–≤–æ–ª—è—é—â–∏–π –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º —á–µ—Ä–µ–∑ API. –ü—Ä–∏–º–µ—Ä:
curl -X POST <ngrok_url>/api/reminders/send-message/ \
  -H "Content-Type: application/json" \
  -d '{"phone_number": "996707828028", "message": "–¢–µ—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ"}'
